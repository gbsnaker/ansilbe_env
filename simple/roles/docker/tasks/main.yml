---
# tasks file for docker

- name: ensure config folder is present
  file:
    path: /etc/docker
    state: directory

- name: ensure graph dirs is present
  file:
    path: /opt/docker_data
    state: directory


- name: ensure run shell dirs is present
  file:
    path: /opt/run
    state: directory




- name: Install python setup tools
    yum: name=python-setuptools
    tags: docker

- name: Install Pypi
    easy_install: name=pip
    tags: docker

- name: Install docker-py
    pip: name=docker-py
    tags: docker

- name: Install Docker
    yum: name=docker state=latest
    tags: docker

#- name: copy daemon.json 
#    template: src=daemon.json.j2 dest=/etc/docker/daemon.j2
#    tags: docker

- name: ensure unit file is present & up to date
  template:
    src: docker.service.j2
    dest: /usr/lib/systemd/system/docker.service
  notify:
    - reload unit
    - restart docker

- name: ensure daemon config file is present
  template:
    src: daemon.json.j2
    dest: /etc/docker/daemon.json
  notify:
    - restart docker


- name: Make sure Docker is running
    service: name=docker state=running
    tags: docker

- name: ensure starts on system boot
  service:
    name: docker
    enabled: yes

